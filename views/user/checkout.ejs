<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Favicon-->
    <link rel="shortcut icon" href="img/fav.png">
    <!-- Author Meta -->
    <meta name="author" content="CodePixar">
    <!-- Meta Description -->
    <meta name="description" content="">
    <!-- Meta Keyword -->
    <meta name="keywords" content="">
    <!-- meta character set -->
    <meta charset="UTF-8">
    <!-- Site Title -->
    <title>Bagdot Shop</title>

    <!--
            CSS
            ============================================= -->
    <link rel="stylesheet" href="user/css/linearicons.css">
    <link rel="stylesheet" href="user/css/owl.carousel.css">
    <link rel="stylesheet" href="user/css/themify-icons.css">
    <link rel="stylesheet" href="user/css/font-awesome.min.css">
    <link rel="stylesheet" href="user/css/nice-select.css">
    <link rel="stylesheet" href="user/css/nouislider.min.css">
    <link rel="stylesheet" href="user/css/bootstrap.css">
    <link rel="stylesheet" href="user/css/main.css">


    <style>
        .tp_btn:hover {
            background-color: orange;
        }
    </style>

    <style>
        .container {
            margin-bottom: 5%;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
        }

        .cart-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card {
            border-radius: 15px;
            box-shadow: 0 14px 16px rgba(232, 225, 225, 0.1);
            /* width: 400px; */
            /* background-color: #c7c7c7;; */
        }

       

        .card-body {
            background-color: #ffffff;
            /* Set the background color */
            border-radius: 10px;
            border: 2px solid;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            /* Add the box shadow */
            padding: 20px;
            margin-bottom: 20px;
        }

        .card-title {
            color: address, daily body, black wall, shadow, danger, Nakoda#007bff;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-label {
            font-weight: bold;
        }

        .form-label span {
            color: red;
        }

        .form-control {
            border-radius: 5px;
            border: 1px solid #ced4da;
            color: black;
            margin-bottom: 15px;
            padding: 10px;
            width: 100%;
        }

        .text-danger {
            font-size: 14px;
            font-style: italic;
            color: red;
            margin-bottom: 10px;
        }

        .btn-primary {
            background-color: orange;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            width: 100%;
        }

        .btn-primary:hover {
            background-color: #0f8415;
        }

        #remove {
            visibility: hidden;
            /* visibility: visible; */
        }

        #discount {
            visibility: hidden;

        }
    </style>

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .cupon_area {
            padding: 20px;
        }

        .check_title {
            margin-bottom: 20px;
        }

        .check_title a {
            text-decoration: none;
            color: #333;
        }

        .check_title a:hover {
            color: #007BFF;
        }

        .coupon-table {
            display: none;
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .coupon-table th,
        .coupon-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .coupon-table th {
            background-color: #f8f8f8;
            color: #333;
        }

        .coupon-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .coupon-table tr:hover {
            background-color: #eaeaea;
        }

        .coupon-table td {
            color: #555;
        }
    </style>

    
    
</head>

<body>

    <!-- Start Header Area -->
<header class="header_area sticky-header">
		<div class="main_menu">
			<nav class="navbar navbar-expand-lg navbar-light main_box">
				<div class="container">
					<!-- Brand and toggle get grouped for better mobile display -->
					<a class="navbar-brand logo_h" href="/"><img src="/user/img/logo.jpg" alt=""
							style="height: 60px;width: 200px;background-color: black;"></a>
					<button class="navbar-toggler" type="button" data-toggle="collapse"
						data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
						aria-expanded="false" aria-label="Toggle navigation">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
						<ul class="nav navbar-nav menu_nav ml-auto">
							<li class="nav-item active"><a class="nav-link" href="/">Home</a></li>
							<li class="nav-item submenu dropdown">
								<li class="nav-item"><a class="nav-link" href="/category/?id=all">Shop Category</a></li>
								
							</li>
							<!-- <li class="nav-item"><a class="nav-link" href="/login">Login</a></li> -->
							
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li class="nav-item"><a href="#" class="cart"><span class="ti-bag"></span></a></li>
							<li class="nav-item">
								<button class="search"><span class="lnr lnr-magnifier" id="search"></span></button>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</div>
    <!-- End Header Area -->

    <!-- Start Banner Area -->
    <section class="banner-area organic-breadcrumb">
        <div class="container">
            <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
                <div class="col-first">
                    <h1>Checkout</h1>
                    <nav class="d-flex align-items-center">
                        <a href="/">Home<span class="lnr lnr-arrow-right"></span></a>
                        <a href="">Checkout</a>
                    </nav>
                </div>
            </div>
        </div>
    </section>
    <!-- End Banner Area -->

    <!--================Checkout Area =================-->
   <section class="checkout_area section_gap">
        <div class="container">
            <div class="returning_customer">
                <!-- <div class="check_title">
                    <h2>Returning Customer? <a href="#">Click here to login</a></h2>
                </div>
                <p>If you have shopped with us before, please enter your details in the boxes below. If you are a new
                    customer, please proceed to the Billing & Shipping section.</p>
                <form class="row contact_form" action="#" method="post" novalidate="novalidate">
                    <div class="col-md-6 form-group p_star">
                        <input type="text" class="form-control" id="name" name="name">
                        <span class="placeholder" data-placeholder="Username or Email"></span>
                    </div>
                    <div class="col-md-6 form-group p_star">
                        <input type="password" class="form-control" id="password" name="password">
                        <span class="placeholder" data-placeholder="Password"></span>
                    </div>
                    <div class="col-md-12 form-group">
                        <button type="submit" value="submit" class="primary-btn">login</button>
                        <div class="creat_account">
                            <input type="checkbox" id="f-option" name="selector">
                            <label for="f-option">Remember me</label>
                        </div>
                        <a class="lost_pass" href="#">Lost your password?</a>
                    </div>
                </form>
            </div> -->
                <div class="cupon_area">
                    <div class="check_title">
                        <a href="" id="couponLink">
                            <h2>Have a coupon?</h2>
                        </a>
                    </div>
                    <table class="coupon-table" id="couponTable">
                        <thead>
                            <tr>
                                <th>COUPON</th>
                                <th>DISCOUNT</th>
                                <th>MIN CART VALUE</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for ( let i=0; i < coupon.length; i++ ) { %>
                                <tr>
                                    <td>
                                        <%= coupon[i].name %>
                                    </td>

                                    <!-- </tr>
                            <tr> -->
                                    <td>
                                        <%= coupon[i].discount %>
                                    </td>
                                    <!-- </tr>
                            <tr> -->
                                    <td>
                                        <%= coupon[i].minimum_cart_value %>
                                    </td>
                                </tr>
                        </tbody>
                        <% } %>
                    </table>

                </div>

                <input type="text" placeholder="Enter coupon code" id="coupon" onclick=" couponApply()">
                <button onclick="applyCoupon()" class="btn btn-primary" style="width: 180px;" id="apply">Apply
                    Coupon</button>
                <button onclick="removeCoupon()" class="btn btn-danger" style="width: 180px;" id="remove">Remove
                    Coupon</button>
            </div>

            <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="shipto" />
                <label class="custom-control-label" for="shipto" data-toggle="collapse"
                    data-target="#shipping-address">Add a delivery address from here</label>
            </div>
            <div class="collapse mb-4" id="shipping-address">
                <br />
                <h3>Billing Details</h3>
                <form action="/addaddressDeliveryAddress" id="addressForm" method="POST"
                    onsubmit="return validateAddress()">


                    <div class="form-group">
                        <label for="fullname" class="form-label">Full Name <span>*</span></label>
                        <input type="text" id="fullname" name="name" class="form-control">
                        <span id="fullnameError" class="text-danger"></span>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="email" class="form-label">Email </label>
                            <input type="email" id="email" name="email" class="form-control">
                            <span id="emailError" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="adname" class="form-label">House Name / Flat No
                                <span>*</span></label>
                            <input type="text" id="adname" name="housename" class="form-control">
                            <span id="adnameError" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="street" class="form-label">Street <span>*</span></label>
                            <input type="text" id="street" name="street" class="form-control">
                            <span id="streetError" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="pincode" class="form-label">Pincode <span>*</span></label>
                            <input type="number" id="pincode" name="pincode" class="form-control">
                            <span id="pincodeError" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="city" class="form-label">City <span>*</span></label>
                            <input type="text" id="city" name="city" class="form-control">
                            <span id="cityError" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="state" class="form-label">State <span>*</span></label>
                            <select id="state" name="state" class="form-control" required>
                                <option value="" disabled selected>Select a state</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="TamilNadu">Tamil Nadu</option>
                            </select>
                            <span id="stateError" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="country" class="form-label">Country <span>*</span></label>
                            <select id="country" name="country" class="form-control" required>
                                <option value="India">India</option>
                            </select>
                            <span id="countryError" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="mobile" class="form-label">Phone Number <span>*</span></label>
                            <input type="number" id="mobile" name="mobile" class="form-control">
                            <span id="mobileError" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="saveas" class="form-label">Save as <span>*</span></label>
                        <select name="saveas" class="form-control" required>
                            <option id="saveas">Choose One</option>
                            <option value="Home">Home</option>
                            <option value="WorkSpace">Work Space</option>
                            <option value="WorkSpace">Other</option>
                        </select>
                        <span id="saveasError" class="text-danger"></span>
                    </div>
                    <div class="form-group text-center">
                        <button id="saveChangesButton" class="btn btn-primary" type="submit">Add
                            Address</button>
                    </div>


                </form>
            </div>

        </div>
        </div>






        <div class="billing_details">
            <div class="row">
                <div class="col-lg-8" style="display: flex; flex-wrap: wrap; gap: 10%;">
                    <% if (!data) { %>

                        <% } else { %>
                            <% for( let i=0; i < data.address.length; i++ ) { %>



                                <div class="col-4" style="margin-right: 10%;">

                                    <div class="card"
                                        style="width: 18rem; margin-bottom: 10%; margin-top: 10%;background-color: #e8f0f2;">
                                        <input type="radio" style="margin-left: -35%;margin-top: 5%;" name="addressId"
                                            id="addressId" onclick="addressSelect('<%= i%>')">
                                        <div style="text-align: center;padding: 5%;color: black;">
                                            <p>Name : <%= data.address[i].Name %>
                                            </p>
                                            <p>Number : <%= data.address[i].Number %>
                                            </p>
                                            <p>Address : <%= data.address[i].Housename %>
                                                    <%= data.address[i].Streetname %>
                                                        <%= data.address[i].City %>
                                                            <%= data.address[i].State %>
                                            </p>
                                            <p>Country : <%= data.address[i].Country %>
                                            </p>
                                            <p>PinCode : <%= data.address[i].Pincode %>
                                            </p>

                                        </div>
                                        <!--  -->
                                    </div>
                                </div>

                                <% } %>


                                    <% } %>




                </div>

                <div class="col-lg-4" style="margin-left: 30%;">
                    <div class="order_box">
                        <h2>Your Order</h2>
                        <ul class="list">
                            <li><a href="#">Product <span>Total</span></a></li>


                            <% for( let i=0; i <cartData.length; i++ ) { %>

                                <li><a href="#">
                                        <%= cartData[i].product %> <span class="middle">x <%= cartData[i].Quantity %>
                                            </span> <span class="last">Rs.<%= cartData[i].Price %></span>
                                    </a></li>
                                <% } %>
                        </ul>
                        <ul class="list list_2">
                            <li><a href="#">Subtotal Rs.<span id="subtotal">
                                        <%= totalAmount %>
                                    </span></a></li>
                            <li><a href="#">Shipping <span>Rs.50.00</span></a></li>
                            <li><a href="#">Discount <span id="discount"></span></a></li>
                            <li><a href="#">Total <span id="totalAmount">Rs.<%= totalAmount+50 %></span></a>
                            </li>
                        </ul>
                        <div class="payment_item">
                            <div class="radion_btn">
                                <input type="radio" id="f-option5" name="selector" onclick="codPaymet('Cod')">
                                <label for="f-option5">Cash on Delivery</label>
                                <div class="check"></div>
                            </div>
                        </div>
                        <div class="payment_item">
                            <div class="radion_btn">
                                <input type="radio" id="f-option7" name="selector" onclick="walletPayment()">
                                <label for="f-option7">Wallet</label><span style="margin-left: 85%;">  Rs.<%= walletData %></span>
                                <div class="check"></div>
                            </div>
                        </div>
                        <div class="payment_item active">
                            <div class="radion_btn">
                                <input type="radio" id="f-option6" name="selector" onclick="onlinePayment()">

                                <label for="f-option6">OnlinePayment </label>
                                <!-- <img src="user/img/product/card.jpg" alt=""> -->
                                <div class="check"></div>
                            </div>
                            <!-- <p>Pay via PayPal; you can pay with your credit card if you don’t have a PayPal
                                    account.</p> -->
                        </div>
                        <!-- <div class="creat_account">
                                <input type="checkbox" id="f-option4" name="selector">
                                <label for="f-option4">I’ve read and accept the </label>
                                <a href="#">terms & conditions*</a>
                            </div> -->
                        <button class="primary-btn" style="width: 100%;border: transparent;"
                            onclick="placeOrder()">Proceed </button>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </section>
    <!--================End Checkout Area =================-->

    <!-- start footer Area -->
    <footer class="footer-area section_gap">
        <div class="container">
            <div class="row">
                <div class="col-lg-3  col-md-6 col-sm-6">
                    <div class="single-footer-widget">
                        <h6>About Us</h6>
                        <p>
                            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt
                            ut labore dolore
                            magna aliqua.
                        </p>
                    </div>
                </div>
                <div class="col-lg-4  col-md-6 col-sm-6">
                    <div class="single-footer-widget">
                        <h6>Newsletter</h6>
                        <p>Stay update with our latest</p>
                        <div class="" id="mc_embed_signup">

                            <form target="_blank" novalidate="true"
                                action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                method="get" class="form-inline">

                                <div class="d-flex flex-row">

                                    <input class="form-control" name="EMAIL" placeholder="Enter Email"
                                        onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter Email '"
                                        required="" type="email">


                                    <button class="click-btn btn btn-default"><i class="fa fa-long-arrow-right"
                                            aria-hidden="true"></i></button>
                                    <div style="position: absolute; left: -5000px;">
                                        <input name="b_36c4fd991d266f23781ded980_aefe40901a" tabindex="-1" value=""
                                            type="text">
                                    </div>

                                    <!-- <div class="col-lg-4 col-md-4">
													<button class="bb-btn btn"><span class="lnr lnr-arrow-right"></span></button>
												</div>  -->
                                </div>
                                <div class="info"></div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3  col-md-6 col-sm-6">
                    <div class="single-footer-widget mail-chimp">
                        <h6 class="mb-20">Instragram Feed</h6>
                        <ul class="instafeed d-flex flex-wrap">
                            <li><img src="user/img/i1.jpg" alt=""></li>
                            <li><img src="user/img/i2.jpg" alt=""></li>
                            <li><img src="user/img/i3.jpg" alt=""></li>
                            <li><img src="user/img/i4.jpg" alt=""></li>
                            <li><img src="user/img/i5.jpg" alt=""></li>
                            <li><img src="user/img/i6.jpg" alt=""></li>
                            <li><img src="user/img/i7.jpg" alt=""></li>
                            <li><img src="user/img/i8.jpg" alt=""></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6 col-sm-6">
                    <div class="single-footer-widget">
                        <h6>Follow Us</h6>
                        <p>Let us be social</p>
                        <div class="footer-social d-flex align-items-center">
                            <a href="#"><i class="fa fa-facebook"></i></a>
                            <a href="#"><i class="fa fa-twitter"></i></a>
                            <a href="#"><i class="fa fa-dribbble"></i></a>
                            <a href="#"><i class="fa fa-behance"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom d-flex justify-content-center align-items-center flex-wrap">
                <p class="footer-text m-0">
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    Copyright &copy;
                    <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is
                    made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com"
                        target="_blank">Colorlib</a>
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </p>
            </div>
        </div>
    </footer>
    <!-- End footer Area -->



    <script>
        // JavaScript validation function here
        function validateAddress() {
            var errors = '';
            var saveas = document.getElementById('saveas').value;
            var fullname = document.getElementById('fullname').value;
            var email = document.getElementById('email').value;
            var adname = document.getElementById('adname').value;
            var street = document.getElementById('street').value;
            var pincode = document.getElementById('pincode').value;
            var city = document.getElementById('city').value;
            var state = document.getElementById('state').value;
            var country = document.getElementById('country').value;
            var mobile = document.getElementById('mobile').value;

            var saveasError = document.getElementById('saveasError');
            var fullnameError = document.getElementById('fullnameError');
            var emailError = document.getElementById('emailError');
            var adnameError = document.getElementById('adnameError');
            var streetError = document.getElementById('streetError');
            var pincodeError = document.getElementById('pincodeError');
            var cityError = document.getElementById('cityError');
            var stateError = document.getElementById('stateError');
            var countryError = document.getElementById('countryError');
            var mobileError = document.getElementById('mobileError');

            saveasError.innerHTML = '';
            fullnameError.innerHTML = '';
            emailError.innerHTML = '';
            adnameError.innerHTML = '';
            streetError.innerHTML = '';
            pincodeError.innerHTML = '';
            cityError.innerHTML = '';
            stateError.innerHTML = '';
            countryError.innerHTML = '';
            mobileError.innerHTML = '';

            var spacesRegex = /^\s*$/; // Regex to check for only spaces

            if (spacesRegex.test(saveas)) {
                saveasError.innerHTML = 'Save as is required.';
                errors += 'Save as is required.\n';
            }
            if (spacesRegex.test(fullname)) {
                fullnameError.innerHTML = 'Full name is required.';
                errors += 'Full name is required.\n';
            }
            if (spacesRegex.test(email)) {
                // emailError.innerHTML = 'Email is required.';
                // errors += 'Email is required.\n';
            } else if (!email.match(/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/)) {
                emailError.innerHTML = 'Invalid email address.';
                errors += 'Invalid email address.\n';
            }
            if (spacesRegex.test(adname)) {
                adnameError.innerHTML = 'House name/Flat no is required.';
                errors += 'House name/Flat no is required.\n';
            }
            if (spacesRegex.test(street)) {
                streetError.innerHTML = 'Street is required.';
                errors += 'Street is required.\n';
            }
            if (spacesRegex.test(pincode)) {
                pincodeError.innerHTML = 'Pincode is required.';
                errors += 'Pincode is required.\n';
            } else if (!pincode.match(/^\d{6}$/)) {
                pincodeError.innerHTML = 'Invalid pincode.';
                errors += 'Invalid pincode.\n';
            }
            if (spacesRegex.test(city)) {
                cityError.innerHTML = 'City is required.';
                errors += 'City is required.\n';
            }
            if (spacesRegex.test(state)) {
                stateError.innerHTML = 'State is required.';
                errors += 'State is required.\n';
            }
            if (spacesRegex.test(country)) {
                countryError.innerHTML = 'Country is required.';
                errors += 'Country is required.\n';
            }
            if (spacesRegex.test(mobile)) {
                mobileError.innerHTML = 'Mobile number is required.';
                errors += 'Mobile number is required.\n';
            } else if (!mobile.match(/^\d{10}$/)) {
                mobileError.innerHTML = 'Invalid mobile number.';
                errors += 'Invalid mobile number.\n';
            }

            if (errors) {
                return false;
            } else {
                return true;
            }
        }

        document.getElementById('saveChangesButton').addEventListener('click', function (event) {
            if (!validateAddress()) {
                event.preventDefault();
            }
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- Include jQuery from a CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <button id="rzp-button1">Pay with Razorpay</button>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>


    <script>
        document.getElementById('couponLink').addEventListener('click', function (event) {
            event.preventDefault();
            var couponTable = document.getElementById('couponTable');
            if (couponTable.style.display === 'none' || couponTable.style.display === '') {
                couponTable.style.display = 'table';
            } else {
                couponTable.style.display = 'none';
            }
        });
    </script>



    <script>


        var addressPosition
        var payment


        //  function couponApply() {
        //   const couponCode = document.getElementById('c_code').value;
        //   const subtotal = document.getElementById('subt').innerText

        //   fetch('/applyCoupon', {
        //     method: "POST",
        //     headers: {
        //       'Content-Type': "application/json"
        //     },
        //     body: JSON.stringify({ couponCode, subtotal })
        //   })
        //     .then(response => response.json())
        //     .then(data => {
        //       if (data.success) {
        //         Swal.fire({
        //           text: "coupon applied",
        //           icon: 'success',
        //           confirmButtonText: 'OK',
        //           customClass: {
        //             title: 'text-danger',
        //             popup: 'swal2-popup-custom',
        //             confirmButton: 'btn btn-danger'
        //           },
        //           showCancelButton: false,
        //           showCloseButton: true,
        //           showLoaderOnConfirm: false,
        //           timer: 3000
        //         });
        //         console.log("ivideumethi")
        //         document.getElementById('dicprice').innerText = "-" + data.dicprice
        //         document.getElementById('total').innerText = `${data.price}`
        //         document.getElementById('amount').value = `${data.price}`



        //       } else {
        //         Swal.fire({
        //           text: data.message,
        //           icon: 'error',
        //           confirmButtonText: 'OK',
        //           customClass: {
        //             title: 'text-danger',
        //             popup: 'swal2-popup-custom',
        //             confirmButton: 'btn btn-danger'
        //           },
        //           showCancelButton: false,
        //           showCloseButton: true,
        //           showLoaderOnConfirm: false,
        //           timer: 3000
        //         });
        //       }
        //     })
        //     .catch(error => {
        //       console.error('Error applying coupon:', error);
        //       alert('An error occurred while applying the coupon. Please try again.');
        //     });
        // }

        // function couponRevoke() {

        //   const couponCode = document.getElementById('c_code').value;
        //   const subtotal = document.getElementById('subt').innerText

        //   fetch('/revokeCoupon', {
        //     method: "POST",
        //     headers: {
        //       'Content-Type': "application/json"
        //     },
        //     body: JSON.stringify({ couponCode, subtotal })
        //   })
        //     .then(response => response.json())
        //     .then(data => {
        //       if (data.success) {
        //         Swal.fire({
        //           text: "coupon revoked",
        //           icon: 'success',
        //           confirmButtonText: 'OK',
        //           customClass: {
        //             title: 'text-danger',
        //             popup: 'swal2-popup-custom',
        //             confirmButton: 'btn btn-danger'
        //           },
        //           showCancelButton: false,
        //           showCloseButton: true,
        //           showLoaderOnConfirm: false,
        //           timer: 3000
        //         });
        //         document.getElementById('dicprice').innerText = 0
        //         document.getElementById('total').innerText = `${data.price}`
        //         document.getElementById('amount').value = `${data.price}`
        //         document.getElementById('c_code').value = ""
        //       } else {
        //         Swal.fire({
        //           text: data.message,
        //           icon: 'error',
        //           confirmButtonText: 'OK',
        //           customClass: {
        //             title: 'text-danger',
        //             popup: 'swal2-popup-custom',
        //             confirmButton: 'btn btn-danger'
        //           },
        //           showCancelButton: false,
        //           showCloseButton: true,
        //           showLoaderOnConfirm: false,
        //           timer: 3000
        //         });
        //       }
        //     })
        //     .catch(error => {
        //       console.error('Error applying coupon:', error);
        //       alert('An error occurred while applying the coupon. Please try again.');
        //     });
        // }


        // applyCoupon code--------------------

        function applyCoupon() {
            var couponCode = document.getElementById('coupon').value;
            console.log(couponCode, 'code-----------')


            $.ajax({
                url: '/applyCoupon',
                data: {
                    code: couponCode
                },
                method: 'post',
                dataType: 'json',
                success: (response) => {

                    if (response.response) {
                        console.log(response)

                        document.getElementById('remove').style.visibility = 'visible';
                        document.getElementById('apply').style.visibility = 'hidden';
                        document.getElementById('discount').style.visibility = 'visible';
                        document.getElementById('discount').innerHTML = 'Rs ' + -response.discount;
                        document.getElementById('totalAmount').innerText = 'Rs ' + response.amount
                        Swal.fire({
                            title: "Coupon Code",
                            text: `${response.msg}`,
                            icon: "success",
                            showConfirmButton: false,
                            timer: 2000,
                        });


                    } else {
                        Swal.fire({
                            title: "Coupon Code",
                            text: `${response.msg}`,
                            icon: "warning",
                            showConfirmButton: false,
                            timer: 2000,
                        });
                    }
                }
            });
        }



        // remove coupon code----------

        function removeCoupon() {
            var couponCode = document.getElementById('coupon').value;
            console.log(couponCode, 'code-----------')


            $.ajax({
                url: '/removeCoupon',
                data: {
                    code: couponCode
                },
                method: 'post',
                dataType: 'json',
                success: (response) => {

                    if (response.response) {
                        console.log(response)
                        Swal.fire({
                            title: "Coupon Code",
                            text: `${response.msg}`,
                            icon: "warning",
                            showConfirmButton: false,
                            timer: 2000,
                        });

                        setTimeout(() => {
                            location.reload();

                        }, 2000)

                    } else {
                        Swal.fire({
                            title: "Coupon Code",
                            text: `${response.msg}`,
                            icon: "warning",
                            showConfirmButton: false,
                            timer: 2000,
                        });
                    }
                }
            });
        }

        function placeOrder() {
            console.log(addressPosition, 'addressPositionn');
            console.log(payment, 'payment');


            if (addressPosition && payment) {

                console.log('both address and payment is selected!!!!')
                if (payment === 'cod') {
                    if (totalAmount >= 1000) {
                        Swal.fire({
                            title: "Above 1000 COD is Not available ",
                            text: "You do not have enough balance in your wallet to complete this purchase.",
                            icon: "warning"
                        });
                    } else if (totalAmount <= 1000) {


                        $.ajax({
                            url: '/placeOrder',
                            data: {
                                addressPos: addressPosition,
                                payment: payment
                            },
                            method: 'post',
                            dataType: 'json',
                            success: (response) => {

                                if (response.response) {
                                    console.log(response)
                                    window.location.href = `orderPlacedSuccessful?id=${response.id}`;

                                } else {
                                    Swal.fire({
                                        title: "Above 1000 COD is Not available ",
                                        text: "You do not have enough balance in your wallet to complete this purchase.",
                                        icon: "warning"
                                    });
                                }
                            }
                        })
                    }
                } else if (payment === 'wallet') {
                    // Check wallet balance
                    console.log('inside payment else if ');
                    $.ajax({
                        url: '/checkWalletBalance',
                        data: {
                            addressPos: addressPosition,
                            payment: payment // Assume you have this variable holding the total order amount
                        },
                        method: 'post',
                        dataType: 'json',
                        success: (response) => {

                            if (response.response) {
                                console.log(response)
                                window.location.href = `orderPlacedSuccessful?id=${response.id}`;
                            } else {
                                Swal.fire({
                                    title: "Insufficient Balance",
                                    text: "You do not have enough balance in your wallet to complete this purchase.",
                                    icon: "warning"
                                });
                            }
                        }
                    });
                } else if (payment === 'online') {
                    console.log('online payment is called')

                    $.ajax({
                        url: "/onlineOrder",
                        data: {
                            addressPos: addressPosition,
                            payment: payment
                        },
                        method: 'post',
                        dataType: 'json',
                        success: function (res) {
                            if (res.success) {
                                console.log(res.success)
                                var options = {
                                    "key": "" + res.key_id + "",
                                    "amount": "" + res.amount + "",
                                    "currency": "INR",
                                    "name": "BagDot",
                                    "description": "" + res.description + "",
                                    // "image": "https://dummyimage.com/600x400/000/fff",
                                    "order_id": "" + res.order_id + "",
                                    "handler": function (response) {
                                        // alert("Payment Succeeded");
                                        // window.open("/","_self")
                                        $.ajax({
                                            url: '/placeOrder',
                                            data: {
                                                addressPos: addressPosition,
                                                payment: payment
                                            },
                                            method: 'post',
                                            dataType: 'json',
                                            success: (response) => {
                                                if (response.response) {
                                                    console.log(response)
                                                    window.location.href = `orderPlacedSuccessful?id=${response.id}`;

                                                }
                                            }
                                        });
                                    },
                                    // "prefill": {
                                    //     "contact": "" + res.contact + "",
                                    //     "name": "" + res.name + "",
                                    //     "email": "" + res.email + ""
                                    // },
                                    // "notes": {
                                    //     "description": "" + res.description + ""
                                    // },
                                    "theme": {
                                        "color": "#2300a3"
                                    }
                                };
                                var razorpayObject = new Razorpay(options);
                                razorpayObject.on('payment.failed', function (response) {
                                    alert("Payment Failed");
                                    window.location.href = `/paymentFailed`;
                                });
                                razorpayObject.open();
                            }
                            else {
                                alert(res.msg);
                            }
                        }
                    })
                }

            } else {
                if (!addressPosition) {
                    Swal.fire({
                        title: "To Proceed",
                        text: "Select Address",
                        icon: "warning"
                    });
                }
                if (!payment) {
                    Swal.fire({
                        title: "To Proceed",
                        text: "Select Payment Method",
                        icon: "warning"
                    });
                }
            }

            console.log('placeOrder function called!!!!');
        }

        function onlinePayment() {
            payment = 'online';
        }
        const totalAmountStr = document.getElementById('subtotal').innerHTML
        const totalAmount = Number(totalAmountStr)
        function codPaymet() {

            payment = 'cod'
        }
        function walletPayment() {
            payment = 'wallet'
        }

        function addressSelect(address) {
            addressPosition = address
        }



    </script>


    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="user/js/vendor/jquery-2.2.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
        integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
        crossorigin="anonymous"></script>
    <script src="user/js/vendor/bootstrap.min.js"></script>
    <script src="user/js/jquery.ajaxchimp.min.js"></script>
    <script src="user/js/jquery.nice-select.min.js"></script>
    <script src="user/js/jquery.sticky.js"></script>
    <script src="user/js/nouislider.min.js"></script>
    <script src="user/js/jquery.magnific-popup.min.js"></script>
    <script src="user/js/owl.carousel.min.js"></script>
    <!--gmaps Js-->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
    <script src="user/js/gmaps.min.js"></script>
    <script src="user/js/main.js"></script>
</body>

</html>